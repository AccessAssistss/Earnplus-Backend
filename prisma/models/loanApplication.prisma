// ####################--------------------Loan Application Model--------------------####################
model LoanApplication {
  id             String              @id @default(uuid())
  customerId     String
  productId      String
  approverId     String?
  loanCode       String              @unique
  score          Int?
  customerStatus CustomerLoanStatus  @default(PENDING)
  internalStatus InternalLoanStatus  @default(OPS_PENDING)
  loanStatus     LoanLifecycleStatus @default(NOT_DISBURSED)
  opsApproved    Boolean             @default(false)
  creditApproved Boolean             @default(false)
  pennyDrop      Boolean             @default(false)
  createdAt      DateTime            @default(now())
  updatedAt      DateTime            @updatedAt
  isDeleted      Boolean             @default(false)

  employee      Employee           @relation(fields: [customerId], references: [id])
  masterProduct MasterProduct      @relation(fields: [productId], references: [id])
  approver      AssociateSubAdmin? @relation(fields: [approverId], references: [id])

  LoanFormData   LoanFormData?
  LoanVkycData   LoanVkycData?
  LoanCrifReport LoanCrifReport?
  LoanCreditData LoanCreditData?

  LoanApplicationLogs LoanApplicationLogs[]
}

// ####################--------------------Loan Form Data Model--------------------####################
model LoanFormData {
  id            String   @id @default(uuid())
  applicationId String   @unique
  formJsonData  Json?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  isDeleted     Boolean  @default(false)

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
}

// ####################--------------------Loan VKYC Data Model--------------------####################
model LoanVkycData {
  id            String   @id @default(uuid())
  applicationId String   @unique
  vkycPdf       String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  isDeleted     Boolean  @default(false)

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
}

// ####################--------------------Loan Credit Data Model--------------------####################
model LoanCreditData {
  id                String   @id @default(uuid())
  applicationId     String   @unique
  crifPdf           String?
  statementPdf      String?
  accountDetailJson Json?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  isDeleted         Boolean  @default(false)

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
}

// ##########----------Loan CRIF Report Model----------##########
model LoanCrifReport {
  id                String   @id @default(uuid())
  loanApplicationId String   @unique
  responseBody      Json
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  loanApplication LoanApplication @relation(fields: [loanApplicationId], references: [id])
}

// ##########----------Loan Application Logs Model----------##########
model LoanApplicationLogs {
  id                String   @id @default(uuid())
  loanApplicationId String
  performedById     String
  assignedToId      String?
  action            String
  remarks           String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  loanApplication LoanApplication    @relation(fields: [loanApplicationId], references: [id])
  performedBy     AssociateSubAdmin  @relation(fields: [performedById], references: [id])
  assignedTo      AssociateSubAdmin? @relation("AssignedTo", fields: [assignedToId], references: [id])
}
