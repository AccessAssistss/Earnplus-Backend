// ####################--------------------Loan Application Model--------------------####################
model LoanApplication {
  id                String              @id @default(uuid())
  customerId        String
  productId         String
  approverId        String?
  loanCode          String              @unique
  crifScore         Int?
  customerStatus    CustomerLoanStatus  @default(PENDING)
  internalStatus    InternalLoanStatus  @default(OPS_PENDING)
  loanStatus        LoanLifecycleStatus @default(NOT_DISBURSED)
  opsApproved       Boolean             @default(false)
  creditApproved    Boolean             @default(false)
  pennyDrop         Boolean             @default(false)
  vkycLink          String?
  vkycLinkCreatedAt DateTime?
  vkycStatus        VKYCStatus          @default(NOT_INITIATED)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  isDeleted         Boolean             @default(false)

  employee      Employee           @relation(fields: [customerId], references: [id])
  masterProduct MasterProduct      @relation(fields: [productId], references: [id])
  approver      AssociateSubAdmin? @relation(fields: [approverId], references: [id])

  LoanFormData     LoanFormData?
  LoanVkycData     LoanVkycData?
  LoanCreditData   LoanCreditData?
  LoanCamsData     LoanCamsData?
  LoanApprovedData LoanApprovedData?
  LoanEmiDetails   LoanEmiDetails?
  LoanBankDetails  LoanBankDetails?

  LoanApplicationLogs LoanApplicationLogs[]
  LoanOtherDocs       LoanOtherDocs[]
}

// ####################--------------------Loan Other Docs Model--------------------####################
model LoanOtherDocs {
  id            String        @id @default(uuid())
  applicationId String
  docName       String?
  docUrl        String?
  status        LoanDocStatus @default(REQUESTED)
  remarks       String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  isDeleted     Boolean       @default(false)

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
}

// ####################--------------------Loan Form Data Model--------------------####################
model LoanFormData {
  id            String   @id @default(uuid())
  applicationId String   @unique
  formJsonData  Json?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  isDeleted     Boolean  @default(false)

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
}

// ####################--------------------Loan VKYC Data Model--------------------####################
model LoanVkycData {
  id            String   @id @default(uuid())
  applicationId String   @unique
  vkycJson      Json?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  isDeleted     Boolean  @default(false)

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
}

// ####################--------------------Loan Cams Data Model--------------------####################
model LoanCamsData {
  id            String   @id @default(uuid())
  applicationId String   @unique
  consentId     String?
  sessionId     String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  isDeleted     Boolean  @default(false)

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
}

// ####################--------------------Loan Credit Data Model--------------------####################
model LoanCreditData {
  id                       String   @id @default(uuid())
  applicationId            String   @unique
  crifPdf                  String?
  crifAccountSummery       Json?
  lastOneYearStatementPdf  String?
  lastSixMonthStatementPdf String?
  statementJson            Json?
  createdAt                DateTime @default(now())
  updatedAt                DateTime @updatedAt
  isDeleted                Boolean  @default(false)

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
}

// ####################--------------------Loan Approved Data Model--------------------####################
model LoanApprovedData {
  id             String       @id @default(uuid())
  applicationId  String       @unique
  approvedAmount Int?
  interestRate   Float?
  tenure         Int?
  interestType   InterestType @default(FLAT)
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  isDeleted      Boolean      @default(false)

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id], onDelete: Cascade)
}

// ####################--------------------Loan EMI Details Model--------------------####################
model LoanEmiDetails {
  id              String   @id @default(uuid())
  applicationId   String   @unique
  emiAmount       Float
  principalEmi    Float?
  interestEmi     Float?
  totalInterest   Float
  totalPayable    Float
  calculationJson Json
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id])
}

// ####################--------------------Loan Bank Details Model--------------------####################
model LoanBankDetails {
  id                String   @id @default(uuid())
  applicationId     String   @unique
  accountholderName String?
  bankAccountNumber String?
  ifsc              String?
  bankName          String?
  accountType       String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  loanApplication LoanApplication @relation(fields: [applicationId], references: [id])
}

// ##########----------Loan Application Logs Model----------##########
model LoanApplicationLogs {
  id                String   @id @default(uuid())
  loanApplicationId String
  performedById     String
  assignedToId      String?
  action            String
  remarks           String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  loanApplication LoanApplication    @relation(fields: [loanApplicationId], references: [id])
  performedBy     AssociateSubAdmin  @relation(fields: [performedById], references: [id])
  assignedTo      AssociateSubAdmin? @relation("AssignedTo", fields: [assignedToId], references: [id])
}
