// ##########----------Product Category Model----------##########
model ProductCategory {
    id           String   @id @default(uuid())
    categoryName String?  @db.VarChar(100)
    createdAt    DateTime @default(now())
    updatedAt    DateTime @updatedAt
    isDeleted    Boolean  @default(false)

    MasterProduct              MasterProduct[]
}

// ##########----------Product Purpose Model----------##########
model ProductPurpose {
    id        String   @id @default(uuid())
    purpose   String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    MasterProductPurpose        MasterProductPurpose[]
}

// ##########----------Product Segment Model----------##########
model ProductSegment {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    MasterProductSegment       MasterProductSegment[]
}

// ##########----------Loan Type Model----------##########
model LoanType {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    MasterProduct              MasterProduct[]
}

// ##########----------Product Partner Model----------##########
model ProductPartner {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    MasterProduct               MasterProduct[]
    VariantProduct              VariantProduct[]
    VariantProductUpdateRequest VariantProductUpdateRequest[]
}

// ##########----------Disbursement Mode Model----------##########
model DisbursementMode {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    FinancialDisbursementMode       FinancialDisbursementMode[]
}

// ##########----------Repayment Mode Model----------##########
model RepaymentModes {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    FinancialRepaymentMode       FinancialRepaymentMode[]
}

// ##########----------Master Product Model----------##########
model MasterProduct {
    id                 String          @id @default(uuid())
    productManagerId   String?
    productId          String?         @db.VarChar(100)
    versionId          Int
    productCode        String?         @db.VarChar(100)
    productName        String?         @db.VarChar(100)
    productCategoryId  String?
    loanTypeId         String
    deliveryChannel    DeliveryChannel
    partnerId          String?
    productDescription String?         @db.VarChar(100)
    status             ProductStatus   @default(Draft)
    createdAt          DateTime        @default(now())
    updatedAt          DateTime        @updatedAt
    isDeleted          Boolean         @default(false)

    productCategory ProductCategory?   @relation(fields: [productCategoryId], references: [id], onDelete: Cascade)
    productManager  AssociateSubAdmin? @relation(fields: [productManagerId], references: [id], onDelete: Cascade)
    loanType        LoanType?          @relation(fields: [loanTypeId], references: [id], onDelete: Cascade)
    productPartner  ProductPartner?    @relation(fields: [partnerId], references: [id], onDelete: Cascade)

    financialTerms            FinancialTerms?
    eligibilityCriteria       EligibilityCriteria?
    creditBureauConfig        CreditBureauConfig?
    masterProductOtherCharges MasterProductOtherCharges?

    MasterProductPurpose        MasterProductPurpose[]
    FinancialDisbursementMode   FinancialDisbursementMode[]
    FinancialRepaymentMode      FinancialRepaymentMode[]
    VariantProduct              VariantProduct[]
    MasterProductVersion        MasterProductVersion[]
    MasterProductSegment        MasterProductSegment[]
    MasterProductField          MasterProductField[]
    LoanApplication             LoanApplication[]
    ProductCreditAssignmentRule ProductCreditAssignmentRule[]
}

// ##########----------Master Product Purpose Model----------##########
model MasterProductPurpose {
    id              String @id @default(uuid())
    masterProductId String
    purposeId       String

    masterProduct  MasterProduct  @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
    productPurpose ProductPurpose @relation(fields: [purposeId], references: [id], onDelete: Cascade)
}

// ##########----------Master Product Segment Model----------##########
model MasterProductSegment {
    id              String @id @default(uuid())
    masterProductId String
    segmentId       String

    masterProduct  MasterProduct  @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
    productSegment ProductSegment @relation(fields: [segmentId], references: [id], onDelete: Cascade)
}

// ##########----------Financial Disbursement Mode Model----------##########
model FinancialDisbursementMode {
    id              String  @id @default(uuid())
    masterProductId String?
    disbursementId  String?

    masterProduct    MasterProduct?    @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
    disbursementMode DisbursementMode? @relation(fields: [disbursementId], references: [id], onDelete: Cascade)
}

// ##########----------Financial Repayment Mode Model----------##########
model FinancialRepaymentMode {
    id              String          @id @default(uuid())
    masterProductId String?
    repaymentId     String?
    masterProduct   MasterProduct?  @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
    RepaymentModes  RepaymentModes? @relation(fields: [repaymentId], references: [id], onDelete: Cascade)
}

// ##########----------Master Product Financial Terms----------##########
model FinancialTerms {
    id                  String       @id @default(uuid())
    masterProductId     String       @unique
    minLoanAmount       Int
    maxLoanAmount       Int
    minTenureMonths     Int
    maxTenureMonths     Int
    interestRateType    InterestType
    interestRateMin     Float
    interestRateMax     Float
    processingFeeType   FeeType
    processingFeeValue  Float
    latePaymentFeeType  FeeType
    latePaymentFeeValue Float
    prepaymentAllowed   Boolean
    prepaymentFeeType   FeeType
    prepaymentFeeValue  Float
    overallGst          Float        @default(0.0)
    emiFrequency        EMIFrequency
    penalApplicable     Boolean      @default(false)
    penalRate           Float        @default(0.0)
    gracePeriod         Int          @default(0)
    renewalFee          Float        @default(0.0)

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
}

// ##########----------Master Product Fee Structure Model----------##########
model EligibilityCriteria {
    id                  String  @id @default(uuid())
    masterProductId     String  @unique
    minAge              Int
    maxAge              Int
    minMonthlyIncome    Int
    minBusinessVintage  Int
    minBureauScore      Int
    coApplicantRequired Boolean @default(false)
    collateralRequired  Boolean @default(false)

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
}

// ##########----------Master Product Security Compliance Model----------##########
model CreditBureauConfig {
    id                      String            @id @default(uuid())
    masterProductId         String            @unique
    creditBureauSources     BureauType[]
    minScoreRequired        Int
    maxActiveLoans          Int
    maxCreditUtilization    Float
    enquiriesLast6Months    Int
    loanDelinquencyAllowed  DelinquencyOption
    bureauDataFreshnessDays Int
    scoreDecayTolerance     Int

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
}

// ##########----------Master Product Other Charges Model----------##########
model MasterProductOtherCharges {
    id                 String   @id @default(uuid())
    masterProductId    String   @unique
    chequeBounceCharge Int?
    dublicateNocCharge Int?
    furnishingCharge   Int?
    chequeSwapCharge   Int?
    revocation         Int?
    documentCopyCharge Int?
    stampDutyCharge    Int?
    nocCharge          Int?
    incidentalCharge   Int?
    createdAt          DateTime @default(now())
    updatedAt          DateTime @updatedAt
    isDeleted          Boolean  @default(false)

    masterProduct MasterProduct? @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
}

// ##########----------Product Field Model----------##########
model Field {
    id          String    @id @default(uuid())
    name        String?
    fieldType   FieldType
    isMainField Boolean   @default(false)
    createdAt   DateTime  @default(now())
    updatedAt   DateTime  @updatedAt
    isDeleted   Boolean   @default(false)

    dropdowns           Dropdown[]
    subFields           SubField[]
    masterProductFields MasterProductField[]
    LoanFieldValue      LoanFieldValue[]
}

// ##########----------Product Field Dropdown Model----------##########
model Dropdown {
    id        String   @id @default(uuid())
    fieldId   String
    value     String?
    label     String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    field Field @relation(fields: [fieldId], references: [id], onDelete: Cascade)

    subFields      SubField[]
    LoanFieldValue LoanFieldValue[]
}

// ##########----------Sub-Field Mapping----------##########
model SubField {
    id         String   @id @default(uuid())
    dropdownId String
    fieldId    String
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt
    isDeleted  Boolean  @default(false)

    dropdown Dropdown @relation(fields: [dropdownId], references: [id], onDelete: Cascade)
    field    Field    @relation(fields: [fieldId], references: [id], onDelete: Cascade)

    LoanFieldValue LoanFieldValue[]
}

// ##########----------Field Category Model----------##########
model FieldCategory {
    id        String   @id @default(uuid())
    name      String   @unique
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    masterProductFields MasterProductField[]
}

// ##########----------Master Product Field Model----------##########
model MasterProductField {
    id              String  @id @default(uuid())
    masterProductId String
    fieldId         String
    categoryId      String?
    isRequired      Boolean @default(false)

    Field         Field          @relation(fields: [fieldId], references: [id], onDelete: Cascade)
    masterProduct MasterProduct? @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
    category      FieldCategory? @relation(fields: [categoryId], references: [id])
}

// ##########----------Product Credit Assignment Rule Model----------##########
model ProductCreditAssignmentRule {
    id              String   @id @default(uuid())
    masterProductId String
    creditManagerId String
    minScore        Int
    maxScore        Int
    chainOrder      Int
    createdAt       DateTime @default(now())
    updatedAt       DateTime @default(now()) @updatedAt
    isDeleted       Boolean  @default(false)

    masterProduct MasterProduct     @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
    creditManager AssociateSubAdmin @relation(fields: [creditManagerId], references: [id])
}

// ##########----------Master Product Version Model----------##########
model MasterProductVersion {
    id              String   @id @default(uuid())
    masterProductId String
    versionId       Int
    snapshot        Json
    createdAt       DateTime @default(now())

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
}
