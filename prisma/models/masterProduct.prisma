// ##########----------Product Category Model----------##########
model ProductCategory {
    id           String   @id @default(uuid())
    categoryName String?  @db.VarChar(100)
    createdAt    DateTime @default(now())
    updatedAt    DateTime @updatedAt
    isDeleted    Boolean  @default(false)

    MasterProduct              MasterProduct[]
    MasterProductUpdateRequest MasterProductUpdateRequest[]
}

// ##########----------Product Purpose Model----------##########
model ProductPurpose {
    id        String   @id @default(uuid())
    purpose   String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    MasterProductPurpose        MasterProductPurpose[]
    masterProductPurposeUpdates MasterProductPurposeUpdate[]
}

// ##########----------Product Segment Model----------##########
model ProductSegment {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    MasterProductSegment       MasterProductSegment[]
    MasterProductSegmentUpdate MasterProductSegmentUpdate[]
}

// ##########----------Loan Type Model----------##########
model LoanType {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    MasterProduct              MasterProduct[]
    MasterProductUpdateRequest MasterProductUpdateRequest[]
}

// ##########----------Product Partner Model----------##########
model ProductPartner {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    MasterProduct              MasterProduct[]
    MasterProductUpdateRequest MasterProductUpdateRequest[]
    VariantProduct             VariantProduct[]
}

// ##########----------Master Product Model----------##########
model MasterProduct {
    id                 String          @id @default(uuid())
    productManagerId   String?
    productCategoryId  String?
    productName        String?         @db.VarChar(100)
    productId          String?         @db.VarChar(100)
    productCode        String?         @db.VarChar(100)
    productDescription String?         @db.VarChar(100)
    versionId          Int
    loanTypeId         String
    deliveryChannel    DeliveryChannel
    partnerId          String?
    status             ProductStatus
    createdAt          DateTime        @default(now())
    updatedAt          DateTime        @updatedAt
    isDeleted          Boolean         @default(false)

    productCategory ProductCategory?   @relation(fields: [productCategoryId], references: [id], onDelete: Cascade)
    productManager  AssociateSubAdmin? @relation(fields: [productManagerId], references: [id], onDelete: Cascade)
    loanType        LoanType?          @relation(fields: [loanTypeId], references: [id], onDelete: Cascade)
    productPartner  ProductPartner?    @relation(fields: [partnerId], references: [id], onDelete: Cascade)

    financialTerms            FinancialTerms?
    eligibilityCriteria       EligibilityCriteria?
    creditBureauConfig        CreditBureauConfig?
    financialStatements       FinancialStatements?
    behavioralData            BehavioralData?
    riskScoring               RiskScoring?
    Collateral                Collateral?
    masterProductOtherCharges MasterProductOtherCharges?
    masterProductRepayment    MasterProductRepayment?

    MasterProductPurpose       MasterProductPurpose[]
    VariantProduct             VariantProduct[]
    MasterProductUpdateRequest MasterProductUpdateRequest[]
    MasterProductVersion       MasterProductVersion[]
    MasterProductSegment       MasterProductSegment[]
    MasterProductDeleteRequest MasterProductDeleteRequest[]
}

// ##########----------Master Product Purpose Model----------##########
model MasterProductPurpose {
    id              String @id @default(uuid())
    masterProductId String
    purposeId       String

    masterProduct  MasterProduct  @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
    productPurpose ProductPurpose @relation(fields: [purposeId], references: [id], onDelete: Cascade)
}

// ##########----------Master Product Segment Model----------##########
model MasterProductSegment {
    id              String @id @default(uuid())
    masterProductId String
    segmentId       String

    masterProduct  MasterProduct  @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
    productSegment ProductSegment @relation(fields: [segmentId], references: [id], onDelete: Cascade)
}

// ##########----------Disbursement Mode Model----------##########
model DisbursementMode {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    FinancialDisbursementMode       FinancialDisbursementMode[]
    FinancialDisbursementModeUpdate FinancialDisbursementModeUpdate[]
}

// ##########----------Repayment Mode Model----------##########
model RepaymentModes {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    FinancialRepaymentMode       FinancialRepaymentMode[]
    FinancialRepaymentModeUpdate FinancialRepaymentModeUpdate[]
}

model FinancialTerms {
    id                  String       @id @default(uuid())
    masterProductId     String       @unique
    minLoanAmount       Int
    maxLoanAmount       Int
    minTenureMonths     Int
    maxTenureMonths     Int
    interestRateType    InterestType
    interestRateMin     Float
    interestRateMax     Float
    processingFeeType   FeeType
    processingFeeValue  Float
    latePaymentFeeType  FeeType
    latePaymentFeeValue Float
    prepaymentAllowed   Boolean
    prepaymentFeeType   FeeType
    prepaymentFeeValue  Float
    emiFrequency        EMIFrequency

    FinancialDisbursementMode FinancialDisbursementMode[]
    FinancialRepaymentMode    FinancialRepaymentMode[]

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
}

// ##########----------Financial Disbursement Mode Model----------##########
model FinancialDisbursementMode {
    id             String @id @default(uuid())
    financialId    String
    disbursementId String

    FinancialTerms   FinancialTerms   @relation(fields: [financialId], references: [id], onDelete: Cascade)
    disbursementMode DisbursementMode @relation(fields: [disbursementId], references: [id], onDelete: Cascade)
}

// ##########----------Financial Repayment Mode Model----------##########
model FinancialRepaymentMode {
    id          String @id @default(uuid())
    financialId String
    repaymentId String

    FinancialTerms FinancialTerms @relation(fields: [financialId], references: [id], onDelete: Cascade)
    RepaymentModes RepaymentModes @relation(fields: [repaymentId], references: [id], onDelete: Cascade)
}

// ##########----------Employment Type Model----------##########
model EmploymentType {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    EligibilityEmploymentType       EligibilityEmploymentType[]
    EligibilityEmploymentTypeUpdate EligibilityEmploymentTypeUpdate[]
}

// ##########----------Document Model----------##########
model Document {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    EligibilityDocument       EligibilityDocument[]
    EligibilityDocumentUpdate EligibilityDocumentUpdate[]
}

// ##########----------Master Product Fee Structure Model----------##########
model EligibilityCriteria {
    id                        String                      @id @default(uuid())
    masterProductId           String                      @unique
    minAge                    Int
    maxAge                    Int
    minMonthlyIncome          Int
    minBusinessVintage        Int
    minBureauScore            Int
    bureauType                BureauType
    blacklistFlags            BlacklistFlag[]
    minDocumentsRequired      EligibilityDocument[]
    documentSubmissionModes   SubmissionMode[]
    documentVerificationModes VerificationMode[]
    employmentTypesAllowed    EligibilityEmploymentType[]

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
}

// ##########----------Eligibility Employment Model----------##########
model EligibilityEmploymentType {
    id            String @id @default(uuid())
    eligibilityId String
    employmentId  String

    EligibilityCriteria EligibilityCriteria @relation(fields: [eligibilityId], references: [id], onDelete: Cascade)
    EmploymentType      EmploymentType      @relation(fields: [employmentId], references: [id], onDelete: Cascade)
}

// ##########----------Eligibility Document Model----------##########
model EligibilityDocument {
    id            String @id @default(uuid())
    eligibilityId String
    documentId    String

    EligibilityCriteria EligibilityCriteria @relation(fields: [eligibilityId], references: [id], onDelete: Cascade)
    Document            Document            @relation(fields: [documentId], references: [id], onDelete: Cascade)
}

// ##########----------Master Product Security Compliance Model----------##########
model CreditBureauConfig {
    id                      String            @id @default(uuid())
    masterProductId         String            @unique
    creditBureauSources     BureauType[]
    minScoreRequired        Int
    maxActiveLoans          Int
    maxCreditUtilization    Float
    enquiriesLast6Months    Int
    loanDelinquencyAllowed  DelinquencyOption
    bureauDataFreshnessDays Int
    customBureauFlags       BlacklistFlag[]
    scoreDecayTolerance     Int

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id])
}

// ##########----------Master Product Financial Statement Model----------##########
model FinancialStatements {
    id                     String                  @id @default(uuid())
    masterProductId        String                  @unique
    minMonthlyCredit       Int
    minAverageBalance      Int
    salaryCreditPattern    SalaryPattern
    bouncesLast3Months     Int
    netIncomeRecognition   IncomeRecognitionMethod
    cashDepositsCapPercent Float
    statementSources       StatementSource[]
    accountTypes           AccountType[]
    pdfParsingRequired     Boolean

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id])
}

// ##########----------Master Product Performance Model----------##########
model BehavioralData {
    id                         String             @id @default(uuid())
    masterProductId            String             @unique
    salaryRegularityThreshold  Int
    spendingConsistencyPercent Float
    upiSpendToIncomeRatio      Float
    billPaymentHistory         BillPaymentHistory
    digitalFootprintRequired   Boolean
    locationConsistencyKm      Int
    repeatBorrowerBehavior     BorrowerBehavior

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id])
}

// ##########----------Score Variable Model----------##########
model ScoreVariable {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    RiskScoreVariable       RiskScoreVariable[]
    RiskScoreVariableUpdate RiskScoreVariableUpdate[]
}

// ##########----------External Score Model----------##########
model ExternalScore {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    RiskExternalScore       RiskExternalScore[]
    RiskExternalScoreUpdate RiskExternalScoreUpdate[]
}

model RiskScoring {
    id                  String              @id @default(uuid())
    masterProductId     String              @unique
    internalScoreVars   RiskScoreVariable[]
    externalScoreInputs RiskExternalScore[]
    riskCategoryMapping Int
    maxDTI              Int
    maxLTV              Int
    coBorrowerRequired  Boolean             @default(false)

    MasterProduct MasterProduct @relation(fields: [masterProductId], references: [id])
}

// ##########----------Risk Score Variable Model----------##########
model RiskScoreVariable {
    id            String @id @default(uuid())
    riskScoringId String
    scoreId       String

    RiskScoring   RiskScoring   @relation(fields: [riskScoringId], references: [id], onDelete: Cascade)
    ScoreVariable ScoreVariable @relation(fields: [scoreId], references: [id], onDelete: Cascade)
}

// ##########----------Risk External Score Model----------##########
model RiskExternalScore {
    id            String @id @default(uuid())
    riskScoringId String
    externalId    String

    RiskScoring   RiskScoring   @relation(fields: [riskScoringId], references: [id], onDelete: Cascade)
    ExternalScore ExternalScore @relation(fields: [externalId], references: [id], onDelete: Cascade)
}

// ##########----------Ownership Document Model----------##########
model OwnershipDocument {
    id        String   @id @default(uuid())
    name      String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    isDeleted Boolean  @default(false)

    CollateralDocument       CollateralDocument[]
    CollateralDocumentUpdate CollateralDocumentUpdate[]
}

model Collateral {
    id                          String                       @id @default(uuid())
    masterProductId             String                       @unique
    collateralType              CollateralType
    collateralValue             Int
    collateralValuationDate     DateTime
    collateralDocs              CollateralDocument[]
    collateralOwnerName         String
    ownershipVerified           OwnershipVerificationStatus
    guarantorRequired           Boolean
    guarantorName               String?
    guarantorRelationship       GuarantorRelationship?
    guarantorPAN                String?                      @db.VarChar(10)
    guarantorCreditBureau       CreditBureau?
    guarantorCreditScore        Int?
    guarantorMonthlyIncome      Int?
    guarantorIncomeProofTypes   IncomeProofType[]
    guarantorVerificationStatus GuarantorVerificationStatus?

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id])
}

// ##########----------Collateral Document Model----------##########
model CollateralDocument {
    id           String @id @default(uuid())
    collateralId String
    docId        String

    Collateral        Collateral        @relation(fields: [collateralId], references: [id], onDelete: Cascade)
    OwnershipDocument OwnershipDocument @relation(fields: [docId], references: [id], onDelete: Cascade)
}

// ##########----------Master Product Other Charges Model----------##########
model MasterProductOtherCharges {
    id                 String   @id @default(uuid())
    masterProductId    String   @unique
    chequeBounceCharge Int?
    dublicateNocCharge Int?
    furnishingCharge   Int?
    chequeSwapCharge   Int?
    revocation         Int?
    documentCopyCharge Int?
    stampDutyCharge    Int?
    nocCharge          Int?
    incidentalCharge   Int?
    createdAt          DateTime @default(now())
    updatedAt          DateTime @updatedAt
    isDeleted          Boolean  @default(false)

    masterProduct MasterProduct? @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
}

// ##########----------Master Product Repayment Model----------##########
model MasterProductRepayment {
    id                          String   @id @default(uuid())
    masterProductId             String   @unique
    penalInterestApplicable     Boolean
    incentiveType               String?
    incentiveValue              Int?
    payoutMode                  String?
    incentiveReversalConditions String?
    createdAt                   DateTime @default(now())
    updatedAt                   DateTime @updatedAt
    isDeleted                   Boolean  @default(false)

    masterProduct MasterProduct? @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
}

// ##########----------Master Product Version Model----------##########
model MasterProductVersion {
    id              String   @id @default(uuid())
    masterProductId String
    versionId       Int
    snapshot        Json
    createdAt       DateTime @default(now())

    masterProduct MasterProduct @relation(fields: [masterProductId], references: [id])
}

// ##########----------Master Product Delete Request Model----------##########
model MasterProductDeleteRequest {
    id              String        @id @default(uuid())
    masterProductId String
    requestedById   String
    status          RequestStatus @default(PENDING)
    reason          String?
    createdAt       DateTime      @default(now())
    updatedAt       DateTime      @updatedAt
    isDeleted       Boolean       @default(false)

    masterProduct MasterProduct     @relation(fields: [masterProductId], references: [id], onDelete: Cascade)
    requestedBy   AssociateSubAdmin @relation(fields: [requestedById], references: [id], onDelete: Cascade)
}
